name: Lemehost UI-Cookie AutoStart

on:
  schedule:
    - cron: "*/5 * * * *"  # 每 5 分钟触发
  workflow_dispatch:

jobs:
  autostart:
    runs-on: ubuntu-latest
    timeout-minutes: 4
    env:
      PANEL_BASE: ${{ secrets.PANEL_BASE }}     # https://lemehost.com
      SERVER_IDS: ${{ secrets.SERVER_IDS }}     # 3302157
      COOKIE: ${{ secrets.COOKIE }}             # 完整 cookie
      CSRF_TOKEN: ${{ secrets.CSRF_TOKEN }}     # x-csrf-token
      TIMEOUT: "20"
      VIEW_PATH_TEMPLATE: "/server/{id}/free-plan"  # 仅用于续期
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Install deps
        run: pip install --no-cache-dir requests
      - name: Run auto-renewal
        run: python leme_cookie_ui_autostart.py
